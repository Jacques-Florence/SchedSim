<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Scheduler: Scheduling simulator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Scheduler
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Scheduling simulator </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#intro">Introduction</a><ul><li class="level2"><a href="#taskModels">Task models</a><ul><li class="level3"><a href="#rt">Real-Time tasks</a></li>
<li class="level3"><a href="#interactive">Interactive processes</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#install">Installation</a></li>
<li class="level1"><a href="#use">Using the simulator</a><ul><li class="level2"><a href="#firstSim">My first simulation</a></li>
<li class="level2"><a href="#taskgen">taskset generation</a><ul><li class="level3"><a href="#hardcoded">programatically</a></li>
<li class="level3"><a href="#random">random</a></li>
<li class="level3"><a href="#xml">XML</a></li>
</ul>
</li>
<li class="level2"><a href="#disciplines">Scheduling disciplines</a></li>
<li class="level2"><a href="#reports">Reports</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>This is a scheduling simulator. It is capable of scheduling both real-time tasks and interactive tasks. The simulator is able to simulate the power consumption as well as the resulting temperature of the processor. The simulator allows for selecting the task scheduling algorithm as well as the frequency gopvernor policy.</p>
<h2><a class="anchor" id="taskModels"></a>
Task models</h2>
<p>The simulator does not schedule real tasks, but models of task behavior in terms of workload and power consumption. Let's look more closely at those models.</p>
<h3><a class="anchor" id="rt"></a>
Real-Time tasks</h3>
<p>Real-time tasks are modelled as an infinite sequence of jobs. Jobs are spawned at a regular interval. Each job is defined as a set amount of work, where every job of the same task has the same amount of work. (WCET)</p>
<h3><a class="anchor" id="interactive"></a>
Interactive processes</h3>
<p>Interactive tasks are modelled as a sequence of workloads and waiting times. The waiting times model the time spent by the task waiting for user input, network, or disk access, etc. The duration of waiting time, as well as the amount of work of each workload segment is random, following an exponential distribution.</p>
<h1><a class="anchor" id="install"></a>
Installation</h1>
<p>The scheduler is a set of static libraries. To install, go to the src directory and run ./buildScript.sh.</p>
<p>The executable can be found in the folder build/ under the name simulator. This will compile the libraries as well as an example use of the simulator.</p>
<h1><a class="anchor" id="use"></a>
Using the simulator</h1>
<h2><a class="anchor" id="firstSim"></a>
My first simulation</h2>
<p>As a first example, let's look at a very simple real-time scheduliong problem. Let's consider two tasks. The first has a period of 15 and a worst-case execution time of 5. The second task has a period of 20 and a wcet of 6. Both tasks are assumed to be deterministic, so that their execution time is always equal to their wcet. We want to schedule this taskset under rate monotonic scheduling.</p>
<p>Let's take a look at the main function file: </p><div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="utils_2configuration_8h.html">utils/configuration.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="programTime_8h.html">utils/programTime.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="freqConstants_8h.html">scheduler/freqConstants.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="schedulingSimulator_8h.html">scheduler/schedulingSimulator.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="schedulerConfiguration_8h.html">scheduler/schedulerConfiguration.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="system_8h.html">scheduler/system.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="process_8h.html">scheduler/process.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="taskSetGenerator_8h.html">scheduler/taskSetGenerator.h</a>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="docmain_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div><div class="line">{</div><div class="line">    <a class="code" href="classUtils_1_1ProgramTime.html#a62862bc8369691df7ef0a00490ba3643">Utils::ProgramTime::init</a>();</div><div class="line">    </div><div class="line">    std::string defaultConfigName = <span class="stringliteral">&quot;configuration/configuration.conf&quot;</span>;</div><div class="line">    std::string configName;</div><div class="line">    configName = (argc == 2 ? argv[1]: defaultConfigName);</div><div class="line"></div><div class="line">    </div><div class="line">    std::shared_ptr&lt;Scheduler::SchedulerConfiguration&gt; conf = std::make_shared&lt;Scheduler::SchedulerConfiguration&gt;(configName);</div><div class="line">    assert(conf != <span class="keyword">nullptr</span>);</div><div class="line">    <a class="code" href="classScheduler_1_1SchedulingSimulator.html">Scheduler::SchedulingSimulator</a> simulator(conf);</div><div class="line"></div><div class="line">    simulator.seedRandomGenerator(123);</div><div class="line">    </div><div class="line">    simulator.createRealTimeTask(0.0, 15.0, 5.0*<a class="code" href="freqConstants_8h.html#a2f670099bd8af05b9c7690c2ce7f9fe3">MINFREQ</a>, 15.0);</div><div class="line">    simulator.createRealTimeTask(0.0, 20.0, 6.0*<a class="code" href="freqConstants_8h.html#a2f670099bd8af05b9c7690c2ce7f9fe3">MINFREQ</a>, 20.0);</div><div class="line"></div><div class="line">    simulator.turnOnProcessor(-0.0001);</div><div class="line">    <a class="code" href="classScheduler_1_1System.html#a7dbbeda31987b4cae38f1de9873271a4">Scheduler::System::getInstance</a>()-&gt;<a class="code" href="classScheduler_1_1System.html#ae2fe48e824b0818925e6c25a07d74d65">printProcessesReport</a>();</div><div class="line"></div><div class="line">    simulator.endSimulation(conf-&gt;getRunningTime());</div><div class="line"></div><div class="line">    simulator.startScheduler();</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line"></div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p> The first step is to create a SchedulerConfiguration object, initialized from a configuration file. Then, we create a SchedulingSimulator object. This is the main object of the simulator. Next, we can create the tasks. The easiest way is via the createRealTimeTask with four arguments:</p>
<ul>
<li>The time at which the task will first be ready</li>
<li>The period at which the task repeats itself</li>
<li>The amount of work to be done. Note that this is not a time duration. The simulator is capable of varying frequency, so the time taken to complete a task is not fixed. But for the moment, we will keep a constant frequency, the minimum frequency of the processor. Therefore, we can specify the amount of work corresponding to a given time duration by multiplying the duration by the processor frequency.</li>
<li>The deadline. Let's make this equal to the period of the task.</li>
</ul>
<p>Next, we specify the time at which the processor should turn on. This value should be less than the starting time of the tasks.</p>
<p>Then, the function endSimulation() is used top specify at what time the simulation should end. In this case, we get the value from the configuration file.</p>
<p>finally, we start the simulation.</p>
<p>Once the main file written, we can build the the simulator (see above). We can now edit the configuration file, located in configuration/configuration.conf</p>
<div class="fragment"><div class="line">[global]</div><div class="line">reportsFolder = .</div><div class="line">record = yes</div><div class="line"></div><div class="line">[scheduler]</div><div class="line">runningTime = 600</div><div class="line">discipline = rmsDiscipline</div><div class="line">governor = minGovernor</div><div class="line">temperatureModel = simpleTemperatureModel</div><div class="line">randomSeed = 1</div><div class="line">distribution = none</div><div class="line"></div><div class="line">logTemperature = yes</div><div class="line">onlyLogTempAfterRatio = 0.0</div><div class="line">thermalResistance = 2.0</div><div class="line">thermalCapacitance = 20.0</div><div class="line"></div><div class="line">logAging = no</div><div class="line"></div><div class="line">[taskSet]</div><div class="line">tasksetSource = compiled</div><div class="line"></div><div class="line"></div></div><!-- fragment --><p> The most important field is the kind of task scheduler to use. In this case, it is rate-monotonic scheduling (rmsScheduler).</p>
<p>When executing the simulation with the -verbose option, a log is displayed: </p><div class="fragment"><div class="line"> -0.000: Starting processor</div><div class="line">  0.000:  Task  0:0: New job</div><div class="line">    Scheduler invoked. Ready queue contains 0(15) </div><div class="line">    Currently running process number 0:0</div><div class="line">  0.000:  Task  1:0: New job</div><div class="line">    Scheduler invoked. Ready queue contains 1(20) </div><div class="line">  5.000:  Task  0:0: Task terminates</div><div class="line">    Processor sleeping</div><div class="line">    Scheduler invoked. Ready queue contains 1(20) </div><div class="line">    Currently running process number 1:0</div><div class="line"> 11.000:  Task  1:0: Task terminates</div><div class="line">    Processor sleeping</div><div class="line">    Scheduler invoked. Ready queue contains nothing</div><div class="line"> 15.000:  Task  0:1: New job</div><div class="line">    Scheduler invoked. Ready queue contains 0(30) </div><div class="line">    Currently running process number 0:1</div><div class="line"> 20.000:  Task  1:1: New job</div><div class="line">    Scheduler invoked. Ready queue contains 1(40) </div><div class="line"> 20.000:  Task  0:1: Task terminates</div><div class="line">    Processor sleeping</div><div class="line">    Scheduler invoked. Ready queue contains 1(40) </div><div class="line">    Currently running process number 1:1</div><div class="line"> 26.000:  Task  1:1: Task terminates</div><div class="line">    Processor sleeping</div><div class="line">    Scheduler invoked. Ready queue contains nothing</div><div class="line"> 30.000:  Task  0:2: New job</div><div class="line">    Scheduler invoked. Ready queue contains 0(45) </div><div class="line">    Currently running process number 0:2</div><div class="line"> 35.000:  Task  0:2: Task terminates</div><div class="line">    Processor sleeping</div><div class="line">    Scheduler invoked. Ready queue contains nothing</div><div class="line"> 40.000:  Task  1:2: New job</div><div class="line">    Scheduler invoked. Ready queue contains 1(60) </div><div class="line">    Currently running process number 1:2</div></div><!-- fragment --><p> it contains the list of all events, along with the time at which they occured. For instance, both tasks spawn a new job at time 0.0. At time 5.0, task with pid 0 terminates. Whenever the task scheduler is invoked, the content of the ready queue is displayed. It comprises the pid of the task as well as its amount of work. It also prints the task currently being executed (or about to be).</p>
<h2><a class="anchor" id="taskgen"></a>
taskset generation</h2>
<h3><a class="anchor" id="hardcoded"></a>
programatically</h3>
<p>The first way to specify the taskset to simulate is to directly write it in C++ code, as we did in the first example.</p>
<h3><a class="anchor" id="random"></a>
random</h3>
<p>Another way to generate tasksets is to do it randomly. First, make sure to replace the createRealTimeTask lines in the main function with the following line: </p><div class="fragment"><div class="line">simulator.initializeTaskSet();</div></div><!-- fragment --><p> To generate the taskset randomly, you will also need to set up the configuration file as follows: In the [taskSet] section, the tasksetSource entry should be set to random, and some values need to be specified: </p><div class="fragment"><div class="line">[taskSet]</div><div class="line">tasksetSource = random</div><div class="line">utilization = 0.7</div><div class="line">nbOfTasks = 3</div><div class="line">seed = 1234</div><div class="line">priorities = no</div><div class="line">powerSpan = 1.0</div></div><!-- fragment --><p> the utilization field lets you specify the processor utilization of the task set. nbOfTasks is the number of tasks. The simulator will then generate a taskset where tasks have random periods and wcet. Some other fields are required. The seed is the seed of the random generator that generates the taskset. This allows you to generate a different taskset by changing the seed value. By setting the priorities field to yes, the tasks will each have a different priority. This characteristic is used by some scheduling algorithms. Finally, powerSpan lets you specify the span of instantaneous power consumption of the different tasks (more on that later).</p>
<h3><a class="anchor" id="xml"></a>
XML</h3>
<p>Tasksets can also be specified via a configuration file. This allows tasksets to be changed without having to recompile the simulator. Also, they provide a structured way to store or transfer taskset data.</p>
<p>An example of XML taskset is in the file xml/taskset.xml</p>
<h2><a class="anchor" id="disciplines"></a>
Scheduling disciplines</h2>
<p>to be continued...</p>
<h2><a class="anchor" id="reports"></a>
Reports</h2>
<p>to be continued... </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 24 2017 15:07:17 for Scheduler by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
